var SKY=function(){var t="http://skyscraper.zenyai.net/api",r=null,e=null,o=function(){var t=Array.prototype.slice.call(arguments),r=t[0],e=t.slice(1);r=r||{};for(var o=0;o<e.length;o++)for(var n in e[o])r[n]=e[o][n];return r},n=function(t,r){var e="";for(var o in r)if(r.hasOwnProperty(o)){var n=r[o];e+=encodeURIComponent(o)+"=",e+=encodeURIComponent(n)+"&"}return""!==e&&(e=e.slice(0,-1),t+="?"+e),t},a=function(t,e){var o=new XMLHttpRequest;o.onreadystatechange=function(){if(4===o.readyState){var t=null;try{t=o.responseText?JSON.parse(o.responseText):""}catch(n){}401===o.status&&(r=null),e(t)}};var a=t.method||"GET";o.open(a,n(t.url,t.params)),o.send("GET"===a?null:JSON.stringify(t.postData))},c=function(){};return c.prototype={constructor:SKY},c.prototype.login=function(o,n,c){var s={url:t+"/auth",params:{user:o,pass:n}},u=function(t){t.auth_token?(r=t.auth_token,e=t.data):console.error(t.error&&t.error.message?t.error.message:"Sky login failed."),c&&c(t)};a(s,u)},c.prototype.logout=function(){r=null,e=null},c.prototype.isLoggedIn=function(){return null!=r},c.prototype.currentSession=function(){var t={auth_token:r,login_data:e};return t},c.prototype.api=function(){var e=Array.prototype.slice.call(arguments),n=function(r){var e={url:t+r.path,method:r.method,params:r.params};a(e,r.callback)},c={path:"",method:"GET",params:{},callback:null};if("string"!=typeof e[0])return void console.error("Path must be a string.");switch(c.path=e[0],typeof e[1]){case"function":c.callback=e[1];break;case"object":c.params=e[1],"function"==typeof e[2]&&(c.callback=e[2]);break;case"string":c.method=e[1],"object"==typeof e[2]?(c.params=e[2],"function"==typeof e[3]&&(c.callback=e[3])):"function"==typeof e[2]&&(c.callback=e[2])}return r?(o(c.params,{auth_token:r}),void n(c)):void console.error("Not authorized.")},c}();